[mariadbd]

# 字符集配置
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci

# 内存配置优化
innodb_buffer_pool_size=512M
tmp_table_size=256M
max_heap_table_size=256M
sort_buffer_size=2M
read_buffer_size=1M
read_rnd_buffer_size=1M
join_buffer_size=4M
thread_stack=256K
binlog_cache_size=128K

# 连接和缓存优化
thread_cache_size=128
table_open_cache=400
table_definition_cache=400
max_connections=200
max_connect_errors=100000
wait_timeout=28800
interactive_timeout=28800

# InnoDB 优化
innodb_flush_log_at_trx_commit=2
innodb_log_buffer_size=64M
innodb_log_file_size=256M
innodb_lock_wait_timeout=50
innodb_rollback_on_timeout=1
innodb_use_native_aio=1

# 错误日志配置
log_error=/var/log/mysql/mariadb-error.log

# 慢查询日志配置
slow_query_log=0
log_queries_not_using_indexes=0
long_query_time=2
slow_query_log_file=/var/log/mysql/mariadb-slow.log

# 通用查询日志配置
general_log=0
general_log_file=/var/log/mysql/mariadb-general.log

# 禁用 DNS 解析功能
skip_name_resolve=1

# 禁用 LOCAL INFILE 功能
local_infile=0

# 时区设置
default_time_zone='+08:00'
